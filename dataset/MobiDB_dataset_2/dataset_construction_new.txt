# Construction of dataset
## General construction
1. Parse annotations from MobiDB. Only consider proteins with curated disorder annotation (https://mobidb.org/api/count?curated-disorder-merge=exists). --> 2,816 proteins
2. Get positives --> 1,044 positives (https://mobidb.org/api/count?curated-disorder-merge=exists&curated-lip-merge=exists)
3. Get negatives --> 1,772 negatives ( fgrep -v -f positives.fasta all.fasta > negatives.fasta)
 4. Remove Titin (Q8WZ42) from dataset, since it's too big for embedding creation --> 1,043 positives

## Construct test set
 0. Randomly choose 200 positives and negatives from the dataset (via choose_proteins.py)
 1. Redundancy reduce from positives using mmseqs-uniqueprot at H-val=0 --> 168 positives	(python -m rostclust uniqueprot <input> <output>)
 2. Redundancy reduce from negatives using mmseqs-uniqueprot at H-val=0 --> 151 negatives
 3. Redundancy reduce negatives against positives using mmseqs-uniqueprot2d at H-val=0 --> 132 negatives (python -m rostclust uniqueprot2d <negatives> <positives> <output_file>) 
 4. Redundancy reduce both test sets against DeepDISObind's and ANCHOR's train set. --> 115 negatives (55,289 residues), 98 positives (55,592 residues) (residue ratio n:p 1:1.0)
 5. Add the excluded proteins to the train set. (fgrep -vFxf <test_set_after_step4> <test_set_before_step4> > <overlap>)

## Construct training set
 To ensure large enough data set size, the training set is less strictly redundancy reduced than the test set (cd-hit -i <input> -o <output> -c 0.4 -n 2)
 1. Redundancy reduce positives using cd-hit at 40% sequence identity --> 777 positives (442,194 residues)
 2. Redundancy reduce negatives using cd-hit at 40% sequence identity --> 1282 negatives 
 3. Redundancy reduce negatives against positives using cd-hit-2d at 40% sequence identity --> 1176 negatives (650,256 residues) (cd-hit-2d -i <positives> -i2 <negatives> -o <negatives_reduced> -c 0.4 -n 2 -s2 0.9)
    (residue ratio n:p 1:0.7)

## Finalize test set
 1. Choose all 115 negatives (55,289 residues) and 80 of positives (70% of negatives = 38,702 residues -> whole proteins -> 38,722 residues) to mirror distribution in training set (in terms of total residue count)
 2. **Final test set: 195 proteins (115 negatives, 80 positives)**
 3. Add the 18 excluded positive proteins to the positive training set --> 795 positives in training

## Finalize train set	
 1. Redundancy reduce training set against test set using mmseqs-uniqueprot at H-val=0. (python -m rostclust uniqueprot2d <train_set> <test_set> <output_file>)
 2. **Final training set: 1780 proteins (X negatives, Y positives)**

[TODO from here] 

## Fine-Tuning

 (2. Remove X proteins from test set to correct for out-of-distribution sampling)